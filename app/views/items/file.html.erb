<%object=Dor::Item.find(params[:id])%>
<% content_ds = object.datastreams['contentMetadata'] %>
<% workspace_files=object.list_files%>
<%

	if workspace_files.include?(params[:file])
		link='/items/'+params[:id]+'/file/?file='+params[:file]
		%>
		Workspace: <a href=<%= link%>><%=params[:file]%><a/>
		<%
	end
	accessioned=has_been_accessioned? object.pid
	content_ds.ng_xml.search('//file[@id=\''+params[:file]+'\']').each do |file|
		if file['shelve'] == 'yes'
			%>
			<br>Stacks: <a href=<%= stacks_url_full_size(object,params[:file])%>><%=params[:file]%></a>
			<%
		end
		if (true or accessioned) and file['preserve'] == 'yes'
			%>
			<br>Preservation: <%=%> <%=link_to params[:file], url_for(:controller => :items, :action => :get_preserved_file, :id => params[:id], :file => params[:file], :version => object.versionMetadata.current_version_id)%>
			<%
			version=object.versionMetadata.current_version_id.to_i - 1
			if version>0
			%><br>Previous Versions:<%
			end
			while version > 0
				%><%= link_to ' V'+version.to_s, url_for(:controller => :items, :action => :get_preserved_file, :id => params[:id], :file => params[:file], :version => version.to_s)%>
				<%version = version -1
			end
		end
	end

	%>
	<br><button onclick="$('.lightBox').dialog('close');return false;">Cancel</button>